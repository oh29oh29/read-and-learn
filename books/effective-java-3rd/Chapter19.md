# 19. 상속을 고려해 설계하고 문서화하라. 그러지 않았따면 상속을 금지하라

메서드를 재정의하면 어떤 일이 일어나는지를 정확히 정리하여 문서로 남겨야 한다.  
즉, 상속용 클래스는 재정의할 수 있는 메서드들을 내부적으로 어떻게 이용하는지(자기사용) 문서로 남겨야 한다.

클래스를 안전하게 상속할 수 있도록 하려면 (상속만 아니었다면 기술하지 않았어야 할) 내부 구현 방식을 설명해야만 한다.

효율적인 하위 클래스를 큰 어려움 없이 만들 수 있게 하려면 클래스의 내부 동작 과정 중간에 끼어들 수 있는 훅(hook)을 잘 선별하여 protected 메서드 형태로 공개해야 할 수도 있다.

> ex. java.util.AbstractList 의 removeRange 메서드

상속용 클래스를 설계할 때 어떤 메서드를 protected 로 노출해야 할지에 대해서 명확한 방법은 없다.

**상속용 클래스를 시험하는 방법은 직접 하위 클래스를 만들어보는 것이 유일하다.**

### 상속을 허용하는 클래스가 지켜야 할 제약
- 상속용 클래스의 생성자는 직접적으로든 간접적으로든 재정의 가능 메서드를 호출해서는 안 된다.
- clone 과 readObject 모두 직접적으로든 간접적으로든 재정의 가능 메서드를 호출해서는 안 된다.
- Serializable 을 구현한 상속용 클래스가 readResolve 나 writeReplace 메서드를 갖는다면 이 메서드들은 private 이 아닌 protected 로 선언해야 한다.

클래스를 상속용으로 설계하려면 엄청난 노력이 들고 그 클래스에 안기는 제약도 상담하다.  
상속용으로 설계하지 않은 클래스는 상속을 금지하도록 하는게 좋다.

### 상속을 금지하는 방법
- 클래스를 final 로 선언
- 모든 생성자를 private 이나 package-private 으로 선언하고 public 정적 팩터리를 제공

일반 클래스라고 상속을 꼭 허용해야겠다면 합당한 방법이 있다.

클래스 내부에서는 재정의 가능 메서드를 사용하지 않게 만들고 이 사실을 문서로 남긴다.  
즉, 재정의 가능 메서드를 호출하는 자기사용 코드를 완벽히 제거하라는 의미다.