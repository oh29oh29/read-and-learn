# 08. 프록시와 연관관계 관리

### 프록시

엔티티를 조회할 때 연관된 엔티티들이 항상 사용되는 것은 아니다.  
JPA는 엔티티가 실제 사용될 때까지 데이터베이스 조회를 지연하는 지연 로딩이라는 방법을 제공한다.  

지연 로딩 기능을 사용하려면 실제 엔티티 객체 대신에 데이터베이스 조회를 지연할 수 있는 가짜 객체가 필요한데 이것을 프록시 객체라고 한다.  

프록시 객체는 실제 객체에 대한 참조를 보관한다.  
프록시 객체의 메서드를 호출하면 프록시 객체는 실제 객체의 메서드를 호출한다.  

프록시 객체는 실제 사용될 때 데이터베이스를 조회해서 실제 엔티티 객체를 생성하는데 이것을 프록시 객체의 초기화라 한다.

### 즉시 로딩과 지연 로딩

프록시 객체는 주로 연관된 엔티티를 지연 로딩할 때 사용한다.  

즉시 로딩: 엔티티를 조회할 때 연관된 엔티티도 함께 조회한다.
- 설정 방법: @ManyToOne(fetch = FetchType.EAGER)

지연 로딩: 연관된 엔티티를 실제 사용할 대 조회한다.
- 설정 방법: @ManyToOne(fetch = FetchType.LAZY)

즉시 로딩 시, 두 테이블을 조회해야 하므로 쿼리를 2번 실행할 것 같지만, 대부분의 JPA 구현체는 즉시 로딩을 최적화하기 위해 가능하면 조인 쿼리를 사용한다.